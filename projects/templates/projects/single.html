{% extends 'base.html' %}
{% load static %}

{% block title %}Project {{ project.name }}{% endblock %}

{% block body %}

<form method="POST">
<section class="flex items-center justify-between">
        <div class="flex items-center gap-1">
            <p class="text-text">Project Stage:</p>
            <select name="projectStage" id="projectStage" class="border-none p-1 z-10">
                {% for stage in stages %}
                    <option value="{{ stage.id }}">
                        {{ stage.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
</section>
<section class="grid grid-cols-4 gap-4">

    <div class="col-span-4 rounded-lg bg-bg shadow p-3 flex justify-between items-center">
        <div class="w-max">
            <h1 class="text-4xl font-bold text-text w-max">
                <input
                    class="bg-transparent focus:outline-none h-full min-w-[200px]"
                    type="text"
                    id="projectName"
                    name="projectName"
                    placeholder="Project Title"
                    value="{{ project.name }}"
                    size="{{ project.name|length|add:2 }}"
                >
            </h1>
        </div>
        <div>
            {% if project.priority == 'low' %}
                <img title="Low priority" src="{% static 'img/Default.svg' %}" alt="Low priority flag">
            {% elif project.priority == 'medium' %}
                <img title="Medium priority" src="{% static 'img/Medium.svg' %}" alt="Medium priority flag">
            {% elif project.priority == 'high' %}
                <img title="High priority" src="{% static 'img/High.svg' %}" alt="High priority flag">
            {% endif %}
        </div>
    </div>

    <div class="col-span-4">
        <p class="text-gray-400">Started At: {{ project.created_at }} - Last Update: {{ project.updated_at }}</p>
    </div>

    <div class="col-span-3 flex flex-col gap-4">
    <!-- START OF LEFT COL -->

    <div class=" rounded-lg bg-bg shadow flex items-center gap-4 p-2">
        {% if project.company.company_name %}
        <div>
            <p>Company: {{ project.company.company_name }}</p>
        </div>
        {% endif %}
        <div>
            <p class="text-text">
                Customer(s):
                {% for customer in project.customers.all %}
                    <a class="underline hover:text-brand-400 transition-all" href="/customer/{{ customer.id }}">{{ customer.first_name }} {{ customer.last_name }}</a>,
                {% endfor %}
            </p>
        </div>
    </div>

    {% if project.description %}
    <div class="rounded-lg bg-bg shadow p-3">
            <h2 class="text-lg mb-2">Description:</h2>
            <p>
                {{ project.description }}
            </p>
    </div>
    {% else %}
    <div class="rounded-lg bg-bg shadow p-3 flex items-center justify-center">
        <p class="text-gray-400 text-center">No Description</p>
    </div>
    {% endif %}

    <div class="flex flex-col rounded-lg bg-bg shadow p-3">
        <label class="text-sm font-medium text-text">Notes:</label>
        <div class="flex w-full">
        <textarea name="notes" id="notes" rows="6" class="border border-gray-300 rounded px-2 py-1 flex-1 shrink-0"></textarea>
        <div class="flex flex-col overflow-y-scroll max-h-[155px] w-[200px] px-1">
            {% for note in notes %}
                <div class="p-2 hover:bg-gray-200">{{ note.title|truncatechars:20 }} - <span class="text-gray-400 text-sm">{{ note.updated_at }}</span></div>
            {% endfor %}
        </div>
        </div>
    </div>

    <!-- END OF LEFT COL -->
    </div>

    <div class="col-span-1 flex flex-col gap-4">
    <!-- START OF RIGHT COL -->

    <div class="rounded-lg bg-bg shadow p-3">
        <p>Project Price: <strong>{{ project.price }}â‚¬</strong></p>
    </div>

    <div class="rounded-lg bg-bg shadow p-3">
        <div>
            <p class="text-text text-lg mb-2">Contributors:</p>
            <div class="flex items-center gap-5 flex-wrap">
            {% for user in project.contributed.all %}
                {% include 'components/user.html' %}
            {% endfor %}
            </div>
        </div>
    </div>

    <div class="flex flex-col rounded-lg bg-bg shadow p-3">
        <h2 class="text-lg font-semibold mb-2">Files <span class="text-gray-400 text-sm font-normal">(Designs, Invoices etc.):</span></h2>
        <div class="flex flex-col items-center justify-center w-full h-full text-center border border-gray-400 border-dashed rounded-lg p-4">
            <input type="file" class="
                block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded file:border-0
                file:text-sm file:font-semibold
                file:bg-brand-400 file:text-text
                hover:file:bg-brand-200
                hover:file:cursor-pointer
            "/>
        </div>
    </div>

    <!-- END OF RIGHT COL -->
    </div>
</section>
</form>

{% endblock %}

{% block extra_scripts %}

{% endblock %}